{% extends "base.html" %}

{% block title %}Login - QuMail{% endblock %}

{% block content %}
<style>
    /* Cyberpunk Background with Animated Blockchain Network */
    body {
        background: linear-gradient(135deg, #0f0f23 0%, #1a0033 50%, #000014 100%);
        min-height: 100vh;
        overflow-x: hidden;
        position: relative;
    }

    /* Animated Background Network */
    .network-bg {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        z-index: -1;
        background: radial-gradient(circle at 20% 80%, rgba(120, 119, 198, 0.3) 0%, transparent 50%),
                    radial-gradient(circle at 80% 20%, rgba(255, 119, 198, 0.15) 0%, transparent 50%),
                    radial-gradient(circle at 40% 40%, rgba(120, 119, 198, 0.1) 0%, transparent 50%);
    }

    .network-nodes {
        position: absolute;
        width: 100%;
        height: 100%;
        opacity: 0.6;
    }

    .node {
        position: absolute;
        width: 4px;
        height: 4px;
        background: #00d4ff;
        border-radius: 50%;
        box-shadow: 0 0 20px #00d4ff;
        animation: pulse 2s infinite alternate;
        will-change: transform, opacity;
    }

    .connection {
        position: absolute;
        height: 1px;
        background: linear-gradient(90deg, transparent, #00d4ff, transparent);
        opacity: 0.3;
    }

    .chain-block {
        position: absolute;
        width: 8px;
        height: 8px;
        background: #00d4ff;
        border: 1px solid #8a2be2;
        border-radius: 2px;
        opacity: 0.6;
        box-shadow: 0 0 4px rgba(0, 212, 255, 0.4);
        animation: blockGlow 3s ease-in-out infinite alternate;
        will-change: transform, background;
    }

    .chain-connector {
        position: absolute;
        width: 3px;
        height: 1px;
        background: #8a2be2;
        opacity: 0.5;
        animation: dataFlow 2s ease-in-out infinite;
        will-change: background;
    }

    .data-pulse {
        position: absolute;
        width: 2px;
        height: 2px;
        background: #00ff88;
        border-radius: 50%;
        box-shadow: 0 0 8px #00ff88;
        animation: pulseTravel 4s linear infinite;
        opacity: 0;
    }

    @keyframes blockGlow {
        0% { 
            box-shadow: 0 0 4px rgba(0, 212, 255, 0.4);
            background: #00d4ff;
            transform: translate3d(0, 0, 0);
        }
        100% { 
            box-shadow: 0 0 10px rgba(0, 212, 255, 0.6);
            background: #8a2be2;
            transform: translate3d(0, 0, 0);
        }
    }

    @keyframes dataFlow {
        0% { 
            background: #8a2be2;
            transform: translate3d(0, 0, 0);
        }
        50% { 
            background: #00ff88;
            transform: translate3d(0, 0, 0);
        }
        100% { 
            background: #8a2be2;
            transform: translate3d(0, 0, 0);
        }
    }

    @keyframes pulseTravel {
        0% { 
            opacity: 0;
            transform: translateX(-10px) scale(0.5);
        }
        10% { 
            opacity: 1;
            transform: translateX(-5px) scale(1);
        }
        90% { 
            opacity: 1;
            transform: translateX(15px) scale(1);
        }
        100% { 
            opacity: 0;
            transform: translateX(20px) scale(0.5);
        }
    }

    /* Orange Wave System */
    .wave-path {
        position: absolute;
        height: 2px;
        background: rgba(255, 165, 0, 0.1);
        border-radius: 1px;
        overflow: hidden;
    }

    .wave-pulse {
        position: absolute;
        top: -4px;
        left: -20px;
        width: 40px;
        height: 10px;
        background: radial-gradient(ellipse, 
            rgba(255, 140, 0, 0.7) 0%, 
            rgba(255, 165, 0, 0.4) 40%,
            transparent 70%);
        border-radius: 50%;
        animation: waveTravel 6s ease-in-out infinite;
        will-change: transform, opacity;
    }

    .wave-ripple {
        position: absolute;
        width: 12px;
        height: 12px;
        border: 1px solid rgba(255, 165, 0, 0.4);
        border-radius: 50%;
        background: rgba(255, 140, 0, 0.1);
        animation: rippleExpand 4s ease-out infinite;
        will-change: transform, opacity;
    }

    .signal-trace {
        position: absolute;
        width: 1px;
        height: 1px;
        background: #ff8c00;
        border-radius: 50%;
        box-shadow: 0 0 4px #ff8c00;
        animation: traceFloat 8s linear infinite;
        opacity: 0.6;
        will-change: transform, opacity;
    }

    @keyframes waveTravel {
        0% { 
            transform: translate3d(-20px, 0, 0) scale3d(0.8, 0.8, 1);
            opacity: 0;
        }
        20% {
            opacity: 1;
            transform: translate3d(0, 0, 0) scale3d(1, 1, 1);
        }
        80% {
            opacity: 1;
            transform: translate3d(80%, 0, 0) scale3d(1, 1, 1);
        }
        100% { 
            transform: translate3d(100%, 0, 0) scale3d(0.8, 0.8, 1);
            opacity: 0;
        }
    }

    @keyframes rippleExpand {
        0% {
            transform: scale3d(0.5, 0.5, 1);
            opacity: 0.6;
        }
        100% {
            transform: scale3d(2, 2, 1);
            opacity: 0;
        }
    }

    @keyframes traceFloat {
        0% {
            transform: translate3d(0, 0, 0) rotate(0deg);
            opacity: 0.4;
        }
        50% {
            transform: translate3d(0, -10px, 0) rotate(180deg);
            opacity: 0.8;
        }
        100% {
            transform: translate3d(0, 0, 0) rotate(360deg);
            opacity: 0.4;
        }
    }

    @keyframes pulse {
        0% { transform: scale3d(1, 1, 1); opacity: 0.7; }
        100% { transform: scale3d(1.3, 1.3, 1); opacity: 1; }
    }

    @keyframes flow {
        0% { transform: translate3d(-100%, 0, 0); }
        100% { transform: translate3d(100%, 0, 0); }
    }

    /* Futuristic Login Container */
    .login-container {
        min-height: 100vh;
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 2rem;
        position: relative;
        z-index: 1;
    }

    /* Glassmorphism Card */
    .cyber-card {
        background: rgba(255, 255, 255, 0.05);
        backdrop-filter: blur(20px);
        border: 1px solid rgba(255, 255, 255, 0.1);
        border-radius: 24px;
        box-shadow: 
            0 25px 45px rgba(0, 0, 0, 0.1),
            inset 0 1px 0 rgba(255, 255, 255, 0.2),
            0 0 80px rgba(0, 212, 255, 0.1);
        padding: 3rem;
        max-width: 480px;
        width: 100%;
        position: relative;
        overflow: hidden;
        animation: cardGlow 4s ease-in-out infinite alternate;
    }

    @keyframes cardGlow {
        0% { box-shadow: 0 25px 45px rgba(0, 0, 0, 0.1), inset 0 1px 0 rgba(255, 255, 255, 0.2), 0 0 80px rgba(0, 212, 255, 0.1); }
        100% { box-shadow: 0 25px 45px rgba(0, 0, 0, 0.1), inset 0 1px 0 rgba(255, 255, 255, 0.2), 0 0 120px rgba(138, 43, 226, 0.15); }
    }

    .cyber-card::before {
        content: '';
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
        animation: shimmer 3s infinite;
    }

    @keyframes shimmer {
        0% { left: -100%; }
        100% { left: 100%; }
    }

    /* Header Styling */
    .cyber-header {
        text-align: center;
        margin-bottom: 3rem;
        position: relative;
    }

    .cyber-title {
        font-size: 3rem;
        font-weight: 700;
        background: linear-gradient(135deg, #00d4ff 0%, #8a2be2 50%, #ff6b9d 100%);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
        margin-bottom: 0.5rem;
        text-shadow: 0 0 30px rgba(0, 212, 255, 0.5);
        animation: titleGlow 2s ease-in-out infinite alternate;
    }

    @keyframes titleGlow {
        0% { filter: brightness(1); }
        100% { filter: brightness(1.2); }
    }

    .cyber-subtitle {
        color: rgba(255, 255, 255, 0.7);
        font-size: 1.1rem;
        font-weight: 300;
        letter-spacing: 2px;
        text-transform: uppercase;
    }

    /* Holographic Input Fields */
    .input-group {
        position: relative;
        margin-bottom: 2rem;
    }

    .floating-label {
        position: absolute;
        top: 50%;
        left: 1rem;
        transform: translateY(-50%);
        color: rgba(255, 255, 255, 0.6);
        font-size: 1rem;
        pointer-events: none;
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        z-index: 2;
    }

    .cyber-input {
        width: 100%;
        padding: 1.2rem 1rem 1.2rem 3rem;
        background: rgba(255, 255, 255, 0.05);
        border: 2px solid rgba(0, 212, 255, 0.3);
        border-radius: 16px;
        color: #ffffff;
        font-size: 1rem;
        outline: none;
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        backdrop-filter: blur(10px);
        position: relative;
    }

    .cyber-input:focus {
        border-color: #00d4ff;
        box-shadow: 
            0 0 0 3px rgba(0, 212, 255, 0.1),
            0 0 30px rgba(0, 212, 255, 0.3),
            inset 0 0 20px rgba(0, 212, 255, 0.05);
        background: rgba(255, 255, 255, 0.08);
    }

    .cyber-input:focus + .floating-label,
    .cyber-input:not(:placeholder-shown) + .floating-label {
        top: -8px;
        left: 1rem;
        font-size: 0.8rem;
        color: #00d4ff;
        background: rgba(15, 15, 35, 0.8);
        padding: 0 0.5rem;
        border-radius: 8px;
    }

    .input-icon {
        position: absolute;
        left: 1rem;
        top: 50%;
        transform: translateY(-50%);
        color: rgba(0, 212, 255, 0.7);
        font-size: 1.1rem;
        z-index: 2;
        transition: all 0.3s ease;
    }

    .cyber-input:focus ~ .input-icon {
        color: #00d4ff;
        filter: drop-shadow(0 0 8px #00d4ff);
    }

    /* Futuristic Button */
    .cyber-button {
        width: 100%;
        padding: 1rem 2rem;
        background: linear-gradient(135deg, #00d4ff 0%, #8a2be2 100%);
        border: none;
        border-radius: 16px;
        color: #ffffff;
        font-size: 1.1rem;
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 1px;
        cursor: pointer;
        position: relative;
        overflow: hidden;
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        box-shadow: 
            0 8px 25px rgba(0, 212, 255, 0.3),
            inset 0 1px 0 rgba(255, 255, 255, 0.2);
    }

    .cyber-button:hover {
        transform: translateY(-2px);
        box-shadow: 
            0 15px 35px rgba(0, 212, 255, 0.4),
            inset 0 1px 0 rgba(255, 255, 255, 0.2),
            0 0 40px rgba(138, 43, 226, 0.3);
    }

    .cyber-button:active {
        transform: translateY(0);
    }

    .cyber-button::before {
        content: '';
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
        transition: left 0.5s;
    }

    .cyber-button:hover::before {
        left: 100%;
    }

    /* Links and Secondary Elements */
    .cyber-link {
        color: #00d4ff;
        text-decoration: none;
        font-weight: 500;
        transition: all 0.3s ease;
        position: relative;
    }

    .cyber-link:hover {
        color: #ffffff;
        text-shadow: 0 0 10px #00d4ff;
    }

    .cyber-link::after {
        content: '';
        position: absolute;
        bottom: -2px;
        left: 0;
        width: 0;
        height: 2px;
        background: linear-gradient(90deg, #00d4ff, #8a2be2);
        transition: width 0.3s ease;
    }

    .cyber-link:hover::after {
        width: 100%;
    }

    /* Security Features Panel */
    .security-panel {
        background: rgba(255, 255, 255, 0.03);
        backdrop-filter: blur(15px);
        border: 1px solid rgba(255, 255, 255, 0.05);
        border-radius: 20px;
        padding: 2rem;
        margin-top: 2rem;
        position: relative;
        overflow: hidden;
    }

    .security-panel::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 1px;
        background: linear-gradient(90deg, transparent, #00d4ff, transparent);
    }

    .security-title {
        color: #ffffff;
        font-size: 1.3rem;
        font-weight: 600;
        margin-bottom: 1.5rem;
        text-align: center;
    }

    .security-feature {
        display: flex;
        align-items: center;
        margin-bottom: 1rem;
        color: rgba(255, 255, 255, 0.8);
        transition: all 0.3s ease;
    }

    .security-feature:hover {
        color: #00d4ff;
        transform: translateX(5px);
    }

    .security-icon {
        color: #00ff88;
        margin-right: 1rem;
        font-size: 1.1rem;
        filter: drop-shadow(0 0 5px #00ff88);
    }

    /* Ripple Effect */
    .ripple {
        position: relative;
        overflow: hidden;
    }

    .ripple::after {
        content: '';
        position: absolute;
        top: 50%;
        left: 50%;
        width: 0;
        height: 0;
        background: rgba(255, 255, 255, 0.3);
        border-radius: 50%;
        transform: translate(-50%, -50%);
        transition: width 0.6s, height 0.6s;
    }

    .ripple:active::after {
        width: 300px;
        height: 300px;
    }

    /* Mobile Responsiveness */
    @media (max-width: 768px) {
        .login-container {
            padding: 1rem;
        }

        .cyber-card {
            padding: 2rem 1.5rem;
        }

        .cyber-title {
            font-size: 2.5rem;
        }
    }

    /* Remove default Bootstrap navbar for login page */
    nav.navbar {
        display: none;
    }

    main.container {
        padding: 0;
        margin: 0;
        max-width: 100%;
    }
</style>

<!-- Animated Background -->
<div class="network-bg">
    <div class="network-nodes" id="networkNodes"></div>
</div>

<div class="login-container">
    <div class="cyber-card">
        <!-- Header -->
        <div class="cyber-header">
            <h1 class="cyber-title">
                <i class="fas fa-shield-alt"></i>
                QuMail
            </h1>
            <p class="cyber-subtitle">Quantum Secure Access Portal</p>
        </div>

        <!-- Login Form -->
        <form method="POST" id="loginForm">
            <div class="input-group">
                <input type="email" class="cyber-input" id="email" name="email" placeholder=" " required>
                <label class="floating-label" for="email">Email Address</label>
                <i class="fas fa-envelope input-icon"></i>
            </div>

            <div class="input-group">
                <input type="password" class="cyber-input" id="password" name="password" placeholder=" " required>
                <label class="floating-label" for="password">Quantum Password</label>
                <i class="fas fa-lock input-icon"></i>
            </div>

            <button type="submit" class="cyber-button ripple">
                <i class="fas fa-sign-in-alt"></i>
                Initialize Secure Connection
            </button>
        </form>

        <!-- Secondary Actions -->
        <div style="text-align: center; margin: 2rem 0;">
            <a href="{{ url_for('forgot_password') }}" class="cyber-link">
                <i class="fas fa-key"></i>
                Recover Access Codes
            </a>
        </div>

        <div style="text-align: center; padding-top: 2rem; border-top: 1px solid rgba(255, 255, 255, 0.1);">
            <p style="color: rgba(255, 255, 255, 0.6); margin-bottom: 1rem;">New to the Quantum Network?</p>
            <a href="{{ url_for('register') }}" class="cyber-link" style="font-size: 1.1rem; font-weight: 600;">
                <i class="fas fa-user-plus"></i>
                Create Secure Account
            </a>
        </div>

        <!-- Security Features Panel -->
        <div class="security-panel">
            <h3 class="security-title">
                <i class="fas fa-shield-alt"></i>
                Advanced Security Protocol
            </h3>
            <div class="security-feature">
                <i class="fas fa-check security-icon"></i>
                <span>Multi-Factor Quantum Authentication</span>
            </div>
            <div class="security-feature">
                <i class="fas fa-check security-icon"></i>
                <span>Post-Quantum Cryptographic Encryption</span>
            </div>
            <div class="security-feature">
                <i class="fas fa-check security-icon"></i>
                <span>Distributed IPFS Storage Network</span>
            </div>
            <div class="security-feature">
                <i class="fas fa-check security-icon"></i>
                <span>Blockchain Integrity Verification</span>
            </div>
        </div>
    </div>
</div>

<script>
    // Generate optimized blockchain network background
    function createNetworkAnimation() {
        const networkNodes = document.getElementById('networkNodes');
        const nodeCount = 25; // Reduced from 50
        const nodes = [];

        // Create nodes with optimized generation
        for (let i = 0; i < nodeCount; i++) {
            const node = document.createElement('div');
            node.className = 'node';
            node.style.left = Math.random() * 100 + '%';
            node.style.top = Math.random() * 100 + '%';
            node.style.animationDelay = (i * 0.1) + 's'; // Sequential delays instead of random
            networkNodes.appendChild(node);
            
            nodes.push({
                element: node,
                x: parseFloat(node.style.left),
                y: parseFloat(node.style.top)
            });
        }

        // Create optimized blockchain connections (reduced complexity)
        let connectionCount = 0;
        const maxConnections = 15; // Limit total connections
        
        for (let i = 0; i < nodes.length && connectionCount < maxConnections; i += 2) { // Skip every other node
            for (let j = i + 1; j < nodes.length && connectionCount < maxConnections; j += 2) {
                const distance = Math.sqrt(
                    Math.pow(nodes[i].x - nodes[j].x, 2) + 
                    Math.pow(nodes[i].y - nodes[j].y, 2)
                );
                
                if (distance < 25) {
                    // Simple connection line
                    const connection = document.createElement('div');
                    connection.className = 'connection';
                    
                    const angle = Math.atan2(nodes[j].y - nodes[i].y, nodes[j].x - nodes[i].x);
                    const length = distance * (window.innerWidth / 100);
                    
                    connection.style.left = nodes[i].x + '%';
                    connection.style.top = nodes[i].y + '%';
                    connection.style.width = length + 'px';
                    connection.style.transform = `rotate(${angle}rad)`;
                    connection.style.transformOrigin = '0 50%';
                    
                    networkNodes.appendChild(connection);
                    connectionCount++;

                    // Add chain block (simplified, only every 3rd connection)
                    if (length > 40 && connectionCount % 3 === 0) {
                        const midX = nodes[i].x + (nodes[j].x - nodes[i].x) * 0.5;
                        const midY = nodes[i].y + (nodes[j].y - nodes[i].y) * 0.5;
                        
                        const block = document.createElement('div');
                        block.className = 'chain-block';
                        block.style.left = midX + '%';
                        block.style.top = midY + '%';
                        block.style.animationDelay = (connectionCount * 0.2) + 's';
                        
                        networkNodes.appendChild(block);

                        // Add wave system (only for select connections)
                        if (connectionCount % 5 === 0) {
                            const wavePath = document.createElement('div');
                            wavePath.className = 'wave-path';
                            wavePath.style.left = nodes[i].x + '%';
                            wavePath.style.top = nodes[i].y + '%';
                            wavePath.style.width = length + 'px';
                            wavePath.style.transform = `rotate(${angle}rad)`;
                            wavePath.style.transformOrigin = '0 50%';
                            
                            const wavePulse = document.createElement('div');
                            wavePulse.className = 'wave-pulse';
                            wavePulse.style.animationDelay = (connectionCount * 0.5) + 's';
                            wavePath.appendChild(wavePulse);
                            
                            networkNodes.appendChild(wavePath);
                        }
                    }
                }
            }
        }

        // Reduced signal traces
        for (let i = 0; i < 4; i++) { // Reduced from 8 to 4
            const trace = document.createElement('div');
            trace.className = 'signal-trace';
            trace.style.left = Math.random() * 100 + '%';
            trace.style.top = Math.random() * 100 + '%';
            trace.style.animationDelay = (i * 2) + 's'; // Sequential delays
            trace.style.animationDuration = '8s'; // Fixed duration
            
            networkNodes.appendChild(trace);
        }
    }

    // Enhanced form interactions
    document.addEventListener('DOMContentLoaded', function() {
        createNetworkAnimation();

        // Add focus/blur animations to inputs
        const inputs = document.querySelectorAll('.cyber-input');
        inputs.forEach(input => {
            input.addEventListener('focus', function() {
                this.parentElement.style.transform = 'translateY(-2px)';
                this.parentElement.style.transition = 'transform 0.3s ease';
            });

            input.addEventListener('blur', function() {
                this.parentElement.style.transform = 'translateY(0)';
            });
        });

        // Add micro-animations to security features
        const features = document.querySelectorAll('.security-feature');
        features.forEach((feature, index) => {
            feature.style.animationDelay = (index * 0.1) + 's';
            feature.style.animation = 'slideInLeft 0.6s ease forwards';
        });
    });

    // Add slideInLeft animation
    const style = document.createElement('style');
    style.textContent = `
        @keyframes slideInLeft {
            from {
                opacity: 0;
                transform: translateX(-20px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }
    `;
    document.head.appendChild(style);

    // Optimized particle effect with throttling
    let lastParticleTime = 0;
    document.addEventListener('mousemove', function(e) {
        const now = Date.now();
        if (now - lastParticleTime < 100) return; // Throttle to every 100ms
        lastParticleTime = now;
        
        const particle = document.createElement('div');
        particle.style.position = 'fixed';
        particle.style.left = e.clientX + 'px';
        particle.style.top = e.clientY + 'px';
        particle.style.width = '2px';
        particle.style.height = '2px';
        particle.style.background = '#00d4ff';
        particle.style.borderRadius = '50%';
        particle.style.pointerEvents = 'none';
        particle.style.zIndex = '1000';
        particle.style.animation = 'particleFade 1s ease-out forwards';
        
        document.body.appendChild(particle);
        
        setTimeout(() => {
            if (particle.parentNode) {
                particle.remove();
            }
        }, 1000);
    });

    // Add particle fade animation
    const particleStyle = document.createElement('style');
    particleStyle.textContent = `
        @keyframes particleFade {
            0% {
                opacity: 1;
                transform: scale(1);
            }
            100% {
                opacity: 0;
                transform: scale(0) translateY(-20px);
            }
        }
    `;
    document.head.appendChild(particleStyle);
</script>
{% endblock %}